---
- name: Start Ray Head
  hosts: all[0]
  vars:
    user_home: "{{ ansible_env.HOME }}"
  tasks:
  - name: Create head service
    become: true
    ansible.builtin.template:
      src: ray-head.service
      dest: /lib/systemd/system/ray.service
      mode: 644
    notify:
    - Restart ray

  - name: Start ray head
    become: true
    ansible.builtin.service:
      name: ray
      state: started

  handlers:
    - name: Restart ray
      become: true
      ansible.builtin.systemd:
        daemon_reload: true
        name: ray
        state: restarted